---
output:
  html_document:
    keep_md: true
---
# The code
```{r cache = TRUE, include = TRUE} 
is_docx_output <- function (fmt = knitr:::pandoc_to()) {
  if (length(fmt) == 0) {
    return(FALSE)
  } else {
    return(fmt == "docx")
  }
}

numberEq.docx <- function (eq, lab, envir = docx.eqcounter) {
  assign(x = "counter", value = get(x = "counter", envir = envir)+1, envir = envir)
  assign(x = gsub("eq:", "", lab), value = get(x = "counter", envir = envir), envir = envir)
  lab <- get("counter", envir = envir)
  return(paste0('$$', eq, '\\;\\;\\;\\;(', lab, ')', '$$'))
}

labEq.docx <- function (lab, envir = docx.eqcounter) {
  return(paste0('(', get(x = gsub("eq:", "", lab), envir = envir), ')'))
}

# if (is_docx_output()) {
  docx.eqcounter <- new.env()
  docx.eqcounter$counter <- 0
# }
```

# Start writing math expressions
### Math expressions
Math expressions written in a pair of double dollar signs, e.g., `$$f(k) = {n \choose k} p^{k} (1-p)^{n-k}$$`, and the output looks like this:
$$f\left(k\right)=\binom{n}{k}p^k\left(1-p\right)^{n-k}$$

If you want to include Equation number using `word_document` or `word_document2` formats `` ``r '' `r numberEq.docx(eq = "f(k) = {n \\choose k} p^{k} (1-p)^{n-k}", lab = "eq:binomial", envir = docx.eqcounter)` `` (note: `envir = docx.eqcounter` is the default), will looks like this:
`r numberEq.docx("f(k) = {n \\choose k} p^{k} (1-p)^{n-k}", "eq:binomial")`

Then you are able to cite equation using `` ``r ''`r labEq.docx("eq:binomial")` ``, e.g. see Equation `r labEq.docx("eq:binomial")`.
